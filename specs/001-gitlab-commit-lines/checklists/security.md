# セキュリティ監査チェックリスト

## アクセストークンの保護 (FR-016, FR-017)

- [x] アクセストークンがフロントエンドの状態に保存されない（`get_gitlab_connection` でトークンを返却しない）
- [x] アクセストークンが開発者コンソールに出力されない（ログ出力時に `mask_sensitive()` を使用）
- [x] アクセストークンがUIに表示されない（入力フィールドは `type="password"`）
- [x] アクセストークンがエラーメッセージに含まれない（`AppError` のメッセージにトークンを含まない）

## メールアドレスの保護 (FR-018, FR-019)

- [x] `authorEmail` がUIに表示されない（`userKey` を使用）
- [x] `authorEmail` がログに出力されない（`mask_email()` を使用）
- [x] 集計結果に `authorEmail` が含まれない（`MonthlyStatsResponse` に `userKey` のみ）

## ストレージセキュリティ

- [x] JSONファイルがユーザーのアプリデータディレクトリに保存される（`dirs::data_local_dir()` を使用）
- [x] 書き込みがアトミックに行われる（一時ファイル + リネーム）
- [x] ファイルパスがハードコードされていない（`paths.rs` で管理）

## APIセキュリティ

- [x] HTTPSのみ許可（GitLab API はHTTPS）
- [x] 認証ヘッダーが正しく設定される（`PRIVATE-TOKEN`）
- [x] レート制限への対応（ページネーションで段階的に取得）

## 入力バリデーション

- [x] GitLab URL が有効なURL形式かチェック（フロントエンドでバリデーション）
- [x] 空のトークンを許可しない（フロントエンドでバリデーション）
- [x] 日付範囲が有効かチェック（開始日 ≤ 終了日）

## エラーハンドリング

- [x] エラーメッセージに機密情報を含まない
- [x] ユーザーに次の行動を示すガイダンスを提供
- [x] スタックトレースをUIに表示しない

## 監査ログ

- [x] トレースログ設定が有効（`tracing-subscriber`）
- [x] ログに機密情報が含まれない（`mask_sensitive()`, `mask_email()` でマスク）
